#+STARTUP: inlineimages
#+OPTIONS: H:1

#+EXPORT_EXCLUDE_TAGS: noexport
#+PROPERTY: header-args :eval never-export
#+LATEX_HEADER: \usepackage{svg}
#+cite_export: basic numeric numeric

* COMMENT Get responses from Formbricks
#+begin_src sh
curl --request GET \
  --url 'https://data.clasp.gu.se/api/v1/management/responses?surveyId=cmdcvog990000mq01yiaa8kvu' \
  --header 'x-api-key: f7dff570e3bf30413640297a41330b15'  
#+end_src

need to parse it to csv which is annoying...

#+begin_src R :results output verbatim :file inter.csv
  library(httr2)
  library(jsonlite)
  suppressMessages({
    library(tidyr)
    library(dplyr)
  })

  req <- request("https://data.clasp.gu.se/api/v1/management/responses?surveyId=cmdcvog990000mq01yiaa8kvu&limit=100") |>
    req_headers("Accept" = "application/json", "x-api-key" = "f7dff570e3bf30413640297a41330b15") |>
    req_perform()
  data <- resp_body_string(req) |>
    fromJSON(flatten = TRUE)
  df <- as_tibble(data$data)
  df_fixed <- df %>%
    mutate(across(where(is.list), ~ sapply(., function(x) paste(x, collapse = ";")))) %>%
    select(starts_with("data.")) %>%
    rename_with(
      ~ gsub("data.","",.x, fixed = TRUE)
    ) %>%
    remame(
      
    )
  df_fixed[,25:27]
  ## write.table(df_fixed[,1:39], sep = ",", row.names = TRUE, col.names = TRUE, quote = TRUE)
#+end_src

#+RESULTS:
| variable      |   L_m |  NL_m | L_sd | NL_sd |
|---------------+-------+-------+------+-------|
| kind          |  2.62 |  2.93 | 2.16 |  2.31 |
| pleasant      |  4.44 |  4.67 | 2.45 |  1.63 |
| warm          |   3.0 |  2.33 | 2.31 |  2.38 |
| friendly      |  3.62 |   3.4 | 2.06 |  2.26 |
| competent     |  3.62 |  3.33 | 2.16 |  2.44 |
| effective     |  4.25 |  3.87 | 1.84 |   2.5 |
| skilled       |  2.44 |   3.4 |  2.1 |   2.2 |
| intellegent   |   4.0 |  4.07 | 2.83 |  2.31 |
| sum_warm      | 13.69 | 13.33 | 5.96 |  5.85 |
| sum_competent | 14.31 | 14.67 | 5.96 |  5.85 |


* Raw data
** table                                                          :noexport:
#+TBLNAME:raw
| prolific_pid             | conditions | attention1 | attention2 | q1a | q1b | q1c | q1d | q1e | q1f | q3a | q3b | q3c | q3d | q3e | q3f | q3g | q3h | q3i | q3j | q3k | q3l | q_6 | q7a | q7b | q7c | q7d | q7e | q7f | q7g | q7h | q7i | q7j | q7k | q7l | q7m | q7n | q_8 | r_kind | r_pleasant | r_warm | r_friendly | r_competent | r_effective | r_skilled | r_intellegent |
|--------------------------+------------+------------+------------+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+--------+------------+--------+------------+-------------+-------------+-----------+---------------|
| 5bbb5e3f118c0600013c3202 |          1 |         -3 |         -3 |   1 |  -1 |   3 |   3 |   3 |  -3 |  -3 |   1 |   0 |  -1 |   0 |   0 |   0 |  -1 |   1 |   0 |   0 |   2 |   6 |   2 |  -3 |   0 |  -1 |   1 |  -3 |   0 |   0 |   2 |   0 |   2 |   1 |   2 |  -3 |   1 |      5 |          6 |      7 |          4 |           1 |           3 |         0 |             2 |
| 67803b5508f3d995ef13696b |          2 |          0 |         -3 |   3 |   3 |   1 |  -3 |   0 |   1 |  -2 |  -1 |  -2 |   1 |  -1 |   0 |   1 |   1 |  -3 |  -2 |  -3 |   3 |   7 |   2 |  -2 |   1 |  -2 |   0 |  -2 |   0 |  -2 |  -1 |  -2 |   0 |  -1 |   1 |   0 |   1 |      0 |          5 |      3 |          1 |           6 |           7 |         2 |             4 |
| 6612990fa0e1d2605331a833 |          2 |          2 |         -3 |   1 |   1 |  -3 |  -3 |  -3 |   1 |   1 |   3 |  -3 |   1 |   1 |   2 |   1 |   2 |  -3 |  -3 |  -3 |  -3 |   8 |  -3 |   0 |  -3 |   1 |   0 |   0 |   0 |   0 |   0 |   0 |   0 |   2 |   0 |   2 |   1 |      6 |          5 |      2 |          3 |           1 |           7 |         0 |             4 |
| 674f22af21d6a0d92c657422 |          1 |          0 |          2 |   3 |   3 |   3 |  -3 |   0 |  -3 |   0 |   0 |  -3 |   3 |   3 |   0 |   0 |   0 |  -3 |  -3 |  -3 |  -3 |  10 |   3 |  -3 |   1 |  -3 |   3 |   2 |   3 |   3 |   2 |  -3 |  -3 |  -3 |   1 |  -2 |   1 |      7 |          6 |      4 |          0 |           5 |           2 |         1 |             3 |
| 5ec96e3609117f0a67231842 |          1 |         -2 |         -3 |  -3 |  -3 |  -3 |  -3 |  -3 |  -3 |   0 |  -1 |   2 |  -2 |  -1 |  -2 |   0 |   0 |   0 |   1 |  -3 |   3 |   5 |   2 |  -1 |   2 |  -1 |   0 |   0 |   0 |  -1 |  -1 |  -2 |  -2 |  -2 |   1 |  -2 |   1 |      3 |          7 |      4 |          5 |           6 |           2 |         1 |             0 |
| 5f39a2fd2d394917284dd66f |          2 |          2 |         -3 |   1 |   3 |  -3 |  -3 |  -3 |   0 |   1 |   2 |  -2 |   2 |   2 |   1 |   2 |   2 |  -3 |  -3 |  -1 |  -2 |   9 |   3 |  -3 |   3 |  -3 |   3 |  -3 |  -3 |  -3 |  -3 |  -3 |  -3 |  -3 |  -3 |  -3 |   1 |      1 |          7 |      0 |          5 |           3 |           4 |         6 |             2 |
| 5b90635a877eab0001d7ba9e |          1 |          0 |         -3 |   1 |   1 |  -1 |  -3 |   1 |   1 |   0 |   1 |  -1 |   2 |   2 |   2 |   2 |   2 |  -2 |  -3 |   1 |  -2 |   9 |   2 |  -2 |   2 |  -1 |   1 |  -1 |   2 |   1 |  -2 |  -2 |  -2 |   1 |   1 |   1 |   2 |      1 |          3 |      2 |          5 |           6 |           4 |         0 |             7 |
| 66015f3971c6f69214564a4f |          1 |         -3 |         -3 |   1 |  -3 |   3 |   3 |  -3 |  -3 |  -3 |  -3 |   3 |  -3 |  -3 |  -3 |  -3 |  -3 |   3 |   3 |  -3 |   3 |   1 |   0 |  -2 |   0 |   1 |   1 |   1 |  -1 |   1 |   0 |   0 |  -1 |  -1 |  -1 |  -1 |   1 |      7 |          4 |      3 |          6 |           2 |           5 |         0 |             1 |
| 67155cf3f170705a5fe7a1a1 |          2 |         -3 |         -3 |  -1 |   1 |   1 |  -3 |  -1 |   0 |   1 |   1 |   0 |   0 |  -1 |  -1 |   0 |   0 |  -2 |  -3 |  -2 |  -1 |   6 |   1 |   0 |   0 |   1 |   0 |   1 |   1 |   0 |   0 |   0 |  -1 |  -2 |   0 |   0 |   1 |      1 |          4 |      2 |          7 |           5 |           3 |         0 |             6 |
| 68b75e854acbece78d1301ab |          1 |          0 |         -1 |   1 |   1 |   1 |   1 |  -1 |   1 |   2 |   1 |   1 |   1 |   1 |   1 |   1 |   0 |   0 |   1 |   1 |  -1 |   9 |   2 |  -1 |   0 |  -1 |   0 |   1 |   0 |   0 |  -1 |  -1 |  -1 |   1 |   2 |  -1 |   3 |      2 |          0 |      3 |          1 |           4 |           6 |         5 |             7 |
| 66d1fdd400acfdbc181f41e0 |          1 |         -1 |         -3 |   1 |  -1 |   3 |   1 |  -3 |  -3 |   1 |   1 |  -1 |   0 |   0 |   1 |   0 |   0 |   1 |   1 |  -2 |   2 |   6 |   1 |  -1 |  -2 |  -1 |  -2 |  -1 |   1 |  -2 |  -1 |  -2 |  -2 |  -1 |   0 |  -2 |   4 |      2 |          6 |      3 |          7 |           4 |           5 |         0 |             1 |
| 5cfccc437189a800011a3606 |          1 |          0 |         -3 |   1 |   3 |   1 |   0 |  -3 |  -1 |   2 |   2 |  -2 |   2 |   2 |   1 |   2 |   1 |  -1 |  -2 |   0 |   0 |   8 |   1 |   0 |   0 |   0 |  -1 |  -1 |   1 |   1 |  -1 |   0 |   0 |  -1 |   1 |  -1 |   1 |      1 |          6 |      0 |          2 |           5 |           3 |         4 |             7 |
| 586fabdf2bd3c900018599a9 |          2 |          0 |         -3 |   1 |   1 |  -1 |   1 |  -1 |  -1 |   0 |   0 |   1 |   1 |   0 |   1 |   0 |  -1 |  -1 |   1 |  -2 |   2 |   5 |   1 |   0 |   0 |   1 |   1 |   1 |   0 |   1 |   0 |  -1 |  -1 |   0 |   1 |  -1 |   1 |      6 |          3 |      2 |          4 |           1 |           7 |         5 |             0 |
| 5d8cef3c28e183001a335ab0 |          1 |          0 |         -3 |   1 |  -1 |   0 |   1 |  -3 |  -3 |  -3 |  -2 |   2 |  -2 |  -1 |  -2 |  -3 |  -2 |   1 |   1 |  -3 |   2 |   2 |  -2 |   1 |  -2 |   1 |  -1 |   2 |   2 |   1 |   1 |  -2 |  -2 |   2 |  -1 |   0 |   1 |      3 |          1 |      0 |          5 |           4 |           7 |         6 |             2 |
| 5d403b7d4e509a0019f664f0 |          1 |          0 |         -3 |   1 |   1 |   3 |  -3 |   1 |  -1 |   2 |   3 |  -3 |   3 |   3 |   3 |   3 |   3 |  -3 |  -3 |   0 |   2 |   9 |  -2 |   1 |   1 |   1 |   2 |   1 |   3 |  -1 |  -2 |   1 |   1 |  -2 |   1 |  -2 |   1 |      1 |          7 |      0 |          2 |           6 |           5 |         3 |             4 |
| 6773d42d35be03a65cf4b3e1 |          2 |          0 |         -3 |   0 |  -3 |   3 |   0 |  -3 |  -3 |  -3 |  -3 |   3 |  -3 |  -3 |  -3 |  -3 |  -3 |   3 |   3 |  -3 |   3 |   1 |   0 |   0 |   1 |  -2 |  -2 |  -3 |   3 |  -3 |   0 |   0 |   0 |  -2 |  -2 |  -3 |   1 |      4 |          6 |      5 |          7 |           0 |           1 |         2 |             3 |
| 65651805d1afb42ba1a55476 |          2 |         -3 |         -3 |   3 |   1 |   1 |   0 |  -3 |  -3 |   2 |   2 |  -2 |   3 |   2 |   3 |   2 |   0 |  -2 |  -3 |   0 |   0 |   9 |   2 |  -2 |   1 |  -2 |   1 |  -1 |   2 |  -2 |  -1 |  -1 |  -1 |  -1 |   1 |  -1 |   2 |      5 |          4 |      7 |          3 |           1 |           2 |         6 |             0 |
| 5f3ec93efbd299158253f283 |          2 |          0 |         -2 |   1 |   3 |   0 |  -1 |   0 |   0 |   1 |   1 |  -1 |   1 |   1 |   1 |   0 |   1 |  -1 |  -2 |   1 |  -1 |   7 |   2 |  -2 |   1 |  -1 |   1 |  -1 |   1 |   0 |  -1 |  -2 |  -2 |  -1 |   1 |  -1 |   1 |      0 |          6 |      1 |          3 |           5 |           2 |         4 |             7 |
| 5ee5defbfe74a3000d106f51 |          1 |         -3 |         -3 |   1 |   3 |  -1 |  -1 |   0 |   0 |   2 |   2 |  -2 |   1 |   2 |   2 |   1 |   1 |  -3 |  -2 |   1 |   1 |   9 |   2 |   1 |   2 |   1 |   2 |   1 |   2 |   1 |   0 |  -1 |  -1 |   1 |   1 |   1 |   1 |      2 |          0 |      6 |          1 |           5 |           7 |         3 |             4 |
| 6130c7f7d0112fa23b17079c |          2 |          0 |         -3 |   3 |   1 |   3 |  -3 |  -3 |  -3 |  -3 |  -1 |   1 |  -2 |  -1 |   1 |  -3 |  -2 |  -2 |  -2 |   0 |   2 |   4 |  -2 |   2 |  -1 |   2 |  -2 |   2 |   1 |   1 |   1 |   1 |   1 |   1 |  -1 |   1 |   1 |      1 |          5 |      0 |          2 |           6 |           4 |         3 |             7 |
| 6023f94d1951e70ae21770ec |          1 |         -1 |         -3 |  -3 |  -3 |   3 |  -3 |  -3 |  -3 |  -2 |  -2 |  -1 |  -3 |   0 |   0 |  -1 |  -2 |  -2 |   0 |  -1 |  -1 |   5 |  -3 |  -3 |  -3 |  -2 |  -3 |  -1 |  -1 |  -3 |  -3 |  -3 |  -3 |  -2 |  -2 |  -1 |   1 |      0 |          2 |      1 |          3 |           7 |           4 |         5 |             6 |
| 55d51a6b8ce09000127d4821 |          2 |          0 |         -3 |   0 |   1 |   1 |  -1 |  -3 |  -1 |  -2 |   0 |   2 |  -2 |  -1 |  -2 |  -3 |  -2 |   0 |  -1 |   0 |   1 |   3 |   2 |   0 |   0 |   1 |   0 |   1 |   1 |   2 |  -2 |  -2 |   0 |  -2 |   2 |  -3 |   1 |      3 |          1 |      0 |          2 |           5 |           6 |         7 |             4 |
| 669a4f388b2de8df723faf1e |          1 |          0 |         -3 |   1 |   1 |   0 |  -1 |   1 |   0 |  -2 |  -2 |   0 |  -2 |  -2 |  -2 |  -2 |  -2 |   1 |   1 |  -3 |   3 |   2 |   3 |  -2 |   2 |   1 |   3 |   0 |   2 |  -2 |  -3 |  -3 |  -3 |  -3 |   3 |  -3 |   3 |      4 |          6 |      7 |          5 |           1 |           3 |         2 |             0 |
| 6759fa50a9bb240e423de357 |          2 |         -1 |         -1 |   1 |   1 |  -1 |  -1 |  -1 |  -1 |  -3 |  -2 |   2 |   0 |  -1 |  -1 |  -1 |  -1 |  -1 |   0 |  -1 |   2 |   2 |   1 |   0 |   0 |  -1 |  -1 |  -1 |  -1 |  -1 |   0 |   0 |   0 |  -1 |   1 |   0 |   1 |      1 |          4 |      2 |          0 |           7 |           5 |         3 |             6 |
| 66a7bf129cddb760981ebcec |          2 |         -3 |         -3 |   0 |  -3 |   3 |   1 |  -3 |  -3 |  -3 |  -3 |  -3 |  -3 |  -3 |  -3 |  -2 |  -2 |   2 |   2 |   0 |   3 |   3 |   2 |   0 |   2 |  -1 |   3 |   3 |   3 |   0 |  -3 |  -3 |  -3 |  -3 |   3 |  -3 |   4 |      1 |          3 |      0 |          2 |           4 |           7 |         6 |             5 |
| 5f98099d48060d0450394002 |          1 |          0 |         -3 |   1 |  -1 |   3 |   1 |  -3 |  -3 |   1 |   0 |  -1 |   2 |   1 |   1 |   1 |   1 |   0 |  -1 |  -3 |   3 |   8 |   2 |  -2 |   1 |  -2 |   2 |  -2 |   1 |  -3 |  -2 |  -2 |  -2 |  -2 |   2 |  -2 |   1 |      0 |          6 |      1 |          2 |           3 |           4 |         5 |             7 |
| 675b5e7290000cc3ac23d411 |          1 |          0 |         -3 |   1 |   1 |   1 |   1 |  -3 |  -3 |  -3 |  -1 |  -1 |  -1 |  -3 |  -2 |  -3 |  -3 |   3 |   3 |  -3 |   3 |   1 |   1 |   0 |   1 |  -1 |   1 |  -3 |  -3 |   1 |  -1 |  -1 |  -1 |  -1 |   1 |  -1 |   2 |      2 |          6 |      3 |          5 |           0 |           4 |         1 |             7 |
| 5c4f7b99b33a5300013dbfdd |          2 |         -3 |         -3 |  -1 |  -1 |  -1 |  -3 |  -3 |  -1 |  -3 |  -3 |   2 |  -2 |  -3 |   1 |  -3 |  -3 |   1 |   1 |  -3 |   3 |   3 |   2 |  -1 |  -2 |  -3 |   1 |   1 |  -1 |   2 |   0 |  -1 |  -2 |  -1 |   2 |  -2 |   1 |      5 |          7 |      6 |          4 |           1 |           0 |         2 |             3 |
| 67c4cf035a34c6ef254906e2 |          1 |          0 |          0 |   1 |   1 |   0 |   1 |   1 |   1 |   0 |   1 |   1 |   1 |   1 |   1 |   0 |   1 |   1 |   0 |   1 |   1 |   7 |   1 |   0 |   1 |   0 |   0 |   0 |   0 |   0 |   0 |   0 |   0 |   0 |   0 |   0 |   3 |      2 |          5 |      4 |          0 |           3 |           6 |         1 |             7 |
| 60984a1b0cce76d16c4ca781 |          2 |         -3 |         -2 |  -3 |  -3 |  -3 |  -3 |  -3 |  -3 |  -3 |  -3 |   0 |  -2 |  -2 |  -3 |  -3 |  -3 |   0 |  -2 |  -2 |   0 |   3 |  -3 |  -3 |  -3 |  -2 |  -1 |  -1 |  -1 |  -1 |   0 |   0 |  -1 |  -2 |  -1 |   0 |   1 |      6 |          4 |      0 |          1 |           5 |           2 |         3 |             7 |
| 66280e8f5cdc35202f29a49a |          1 |          0 |         -1 |   1 |   1 |  -1 |   1 |  -1 |   1 |  -2 |  -3 |   3 |  -2 |  -3 |   1 |  -2 |  -3 |   2 |   3 |  -3 |   3 |   2 |   2 |  -2 |   0 |   1 |   1 |  -3 |   1 |   1 |  -2 |  -3 |  -3 |   1 |   1 |  -1 |   4 |      7 |          6 |      4 |          5 |           1 |           0 |         3 |             2 |
| 5ed9ee3afd7ffe59917d3dfa |          2 |          0 |         -3 |   1 |  -1 |  -3 |   0 |  -3 |  -3 |  -2 |  -2 |   1 |  -2 |  -2 |   1 |  -3 |  -2 |   1 |   1 |  -2 |   3 |   2 |   2 |  -2 |   2 |  -2 |   1 |  -1 |   1 |  -1 |  -2 |  -2 |  -2 |  -2 |   2 |  -2 |   2 |      4 |          6 |      5 |          7 |           0 |           1 |         2 |             3 |
** Filter by attention checks                                     :noexport:
  #+NAME: raw-attention
  #+BEGIN_SRC elisp :var tbl=raw :colnames y :exports none
    (cl-loop for row in tbl
             if (not (or (> (nth 3 row) 0)
                         ;; (and (not (= (nth 2 row) 0))
                         ;;      (not (= (nth 2 row) -3)))
                    ))
             collect row into newtbl
             finally return newtbl)
  #+END_SRC

  #+RESULTS: raw-attention
  | prolific_pid             | conditions | attention1 | attention2 | q1a | q1b | q1c | q1d | q1e | q1f | q3a | q3b | q3c | q3d | q3e | q3f | q3g | q3h | q3i | q3j | q3k | q3l | q_6 | q7a | q7b | q7c | q7d | q7e | q7f | q7g | q7h | q7i | q7j | q7k | q7l | q7m | q7n | q_8 | r_kind | r_pleasant | r_warm | r_friendly | r_competent | r_effective | r_skilled | r_intellegent |
  |--------------------------+------------+------------+------------+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+--------+------------+--------+------------+-------------+-------------+-----------+---------------|
  | 5bbb5e3f118c0600013c3202 |          1 |         -3 |         -3 |   1 |  -1 |   3 |   3 |   3 |  -3 |  -3 |   1 |   0 |  -1 |   0 |   0 |   0 |  -1 |   1 |   0 |   0 |   2 |   6 |   2 |  -3 |   0 |  -1 |   1 |  -3 |   0 |   0 |   2 |   0 |   2 |   1 |   2 |  -3 |   1 |      5 |          6 |      7 |          4 |           1 |           3 |         0 |             2 |
  | 67803b5508f3d995ef13696b |          2 |          0 |         -3 |   3 |   3 |   1 |  -3 |   0 |   1 |  -2 |  -1 |  -2 |   1 |  -1 |   0 |   1 |   1 |  -3 |  -2 |  -3 |   3 |   7 |   2 |  -2 |   1 |  -2 |   0 |  -2 |   0 |  -2 |  -1 |  -2 |   0 |  -1 |   1 |   0 |   1 |      0 |          5 |      3 |          1 |           6 |           7 |         2 |             4 |
  | 6612990fa0e1d2605331a833 |          2 |          2 |         -3 |   1 |   1 |  -3 |  -3 |  -3 |   1 |   1 |   3 |  -3 |   1 |   1 |   2 |   1 |   2 |  -3 |  -3 |  -3 |  -3 |   8 |  -3 |   0 |  -3 |   1 |   0 |   0 |   0 |   0 |   0 |   0 |   0 |   2 |   0 |   2 |   1 |      6 |          5 |      2 |          3 |           1 |           7 |         0 |             4 |
  | 5ec96e3609117f0a67231842 |          1 |         -2 |         -3 |  -3 |  -3 |  -3 |  -3 |  -3 |  -3 |   0 |  -1 |   2 |  -2 |  -1 |  -2 |   0 |   0 |   0 |   1 |  -3 |   3 |   5 |   2 |  -1 |   2 |  -1 |   0 |   0 |   0 |  -1 |  -1 |  -2 |  -2 |  -2 |   1 |  -2 |   1 |      3 |          7 |      4 |          5 |           6 |           2 |         1 |             0 |
  | 5f39a2fd2d394917284dd66f |          2 |          2 |         -3 |   1 |   3 |  -3 |  -3 |  -3 |   0 |   1 |   2 |  -2 |   2 |   2 |   1 |   2 |   2 |  -3 |  -3 |  -1 |  -2 |   9 |   3 |  -3 |   3 |  -3 |   3 |  -3 |  -3 |  -3 |  -3 |  -3 |  -3 |  -3 |  -3 |  -3 |   1 |      1 |          7 |      0 |          5 |           3 |           4 |         6 |             2 |
  | 5b90635a877eab0001d7ba9e |          1 |          0 |         -3 |   1 |   1 |  -1 |  -3 |   1 |   1 |   0 |   1 |  -1 |   2 |   2 |   2 |   2 |   2 |  -2 |  -3 |   1 |  -2 |   9 |   2 |  -2 |   2 |  -1 |   1 |  -1 |   2 |   1 |  -2 |  -2 |  -2 |   1 |   1 |   1 |   2 |      1 |          3 |      2 |          5 |           6 |           4 |         0 |             7 |
  | 66015f3971c6f69214564a4f |          1 |         -3 |         -3 |   1 |  -3 |   3 |   3 |  -3 |  -3 |  -3 |  -3 |   3 |  -3 |  -3 |  -3 |  -3 |  -3 |   3 |   3 |  -3 |   3 |   1 |   0 |  -2 |   0 |   1 |   1 |   1 |  -1 |   1 |   0 |   0 |  -1 |  -1 |  -1 |  -1 |   1 |      7 |          4 |      3 |          6 |           2 |           5 |         0 |             1 |
  | 67155cf3f170705a5fe7a1a1 |          2 |         -3 |         -3 |  -1 |   1 |   1 |  -3 |  -1 |   0 |   1 |   1 |   0 |   0 |  -1 |  -1 |   0 |   0 |  -2 |  -3 |  -2 |  -1 |   6 |   1 |   0 |   0 |   1 |   0 |   1 |   1 |   0 |   0 |   0 |  -1 |  -2 |   0 |   0 |   1 |      1 |          4 |      2 |          7 |           5 |           3 |         0 |             6 |
  | 68b75e854acbece78d1301ab |          1 |          0 |         -1 |   1 |   1 |   1 |   1 |  -1 |   1 |   2 |   1 |   1 |   1 |   1 |   1 |   1 |   0 |   0 |   1 |   1 |  -1 |   9 |   2 |  -1 |   0 |  -1 |   0 |   1 |   0 |   0 |  -1 |  -1 |  -1 |   1 |   2 |  -1 |   3 |      2 |          0 |      3 |          1 |           4 |           6 |         5 |             7 |
  | 66d1fdd400acfdbc181f41e0 |          1 |         -1 |         -3 |   1 |  -1 |   3 |   1 |  -3 |  -3 |   1 |   1 |  -1 |   0 |   0 |   1 |   0 |   0 |   1 |   1 |  -2 |   2 |   6 |   1 |  -1 |  -2 |  -1 |  -2 |  -1 |   1 |  -2 |  -1 |  -2 |  -2 |  -1 |   0 |  -2 |   4 |      2 |          6 |      3 |          7 |           4 |           5 |         0 |             1 |
  | 5cfccc437189a800011a3606 |          1 |          0 |         -3 |   1 |   3 |   1 |   0 |  -3 |  -1 |   2 |   2 |  -2 |   2 |   2 |   1 |   2 |   1 |  -1 |  -2 |   0 |   0 |   8 |   1 |   0 |   0 |   0 |  -1 |  -1 |   1 |   1 |  -1 |   0 |   0 |  -1 |   1 |  -1 |   1 |      1 |          6 |      0 |          2 |           5 |           3 |         4 |             7 |
  | 586fabdf2bd3c900018599a9 |          2 |          0 |         -3 |   1 |   1 |  -1 |   1 |  -1 |  -1 |   0 |   0 |   1 |   1 |   0 |   1 |   0 |  -1 |  -1 |   1 |  -2 |   2 |   5 |   1 |   0 |   0 |   1 |   1 |   1 |   0 |   1 |   0 |  -1 |  -1 |   0 |   1 |  -1 |   1 |      6 |          3 |      2 |          4 |           1 |           7 |         5 |             0 |
  | 5d8cef3c28e183001a335ab0 |          1 |          0 |         -3 |   1 |  -1 |   0 |   1 |  -3 |  -3 |  -3 |  -2 |   2 |  -2 |  -1 |  -2 |  -3 |  -2 |   1 |   1 |  -3 |   2 |   2 |  -2 |   1 |  -2 |   1 |  -1 |   2 |   2 |   1 |   1 |  -2 |  -2 |   2 |  -1 |   0 |   1 |      3 |          1 |      0 |          5 |           4 |           7 |         6 |             2 |
  | 5d403b7d4e509a0019f664f0 |          1 |          0 |         -3 |   1 |   1 |   3 |  -3 |   1 |  -1 |   2 |   3 |  -3 |   3 |   3 |   3 |   3 |   3 |  -3 |  -3 |   0 |   2 |   9 |  -2 |   1 |   1 |   1 |   2 |   1 |   3 |  -1 |  -2 |   1 |   1 |  -2 |   1 |  -2 |   1 |      1 |          7 |      0 |          2 |           6 |           5 |         3 |             4 |
  | 6773d42d35be03a65cf4b3e1 |          2 |          0 |         -3 |   0 |  -3 |   3 |   0 |  -3 |  -3 |  -3 |  -3 |   3 |  -3 |  -3 |  -3 |  -3 |  -3 |   3 |   3 |  -3 |   3 |   1 |   0 |   0 |   1 |  -2 |  -2 |  -3 |   3 |  -3 |   0 |   0 |   0 |  -2 |  -2 |  -3 |   1 |      4 |          6 |      5 |          7 |           0 |           1 |         2 |             3 |
  | 65651805d1afb42ba1a55476 |          2 |         -3 |         -3 |   3 |   1 |   1 |   0 |  -3 |  -3 |   2 |   2 |  -2 |   3 |   2 |   3 |   2 |   0 |  -2 |  -3 |   0 |   0 |   9 |   2 |  -2 |   1 |  -2 |   1 |  -1 |   2 |  -2 |  -1 |  -1 |  -1 |  -1 |   1 |  -1 |   2 |      5 |          4 |      7 |          3 |           1 |           2 |         6 |             0 |
  | 5f3ec93efbd299158253f283 |          2 |          0 |         -2 |   1 |   3 |   0 |  -1 |   0 |   0 |   1 |   1 |  -1 |   1 |   1 |   1 |   0 |   1 |  -1 |  -2 |   1 |  -1 |   7 |   2 |  -2 |   1 |  -1 |   1 |  -1 |   1 |   0 |  -1 |  -2 |  -2 |  -1 |   1 |  -1 |   1 |      0 |          6 |      1 |          3 |           5 |           2 |         4 |             7 |
  | 5ee5defbfe74a3000d106f51 |          1 |         -3 |         -3 |   1 |   3 |  -1 |  -1 |   0 |   0 |   2 |   2 |  -2 |   1 |   2 |   2 |   1 |   1 |  -3 |  -2 |   1 |   1 |   9 |   2 |   1 |   2 |   1 |   2 |   1 |   2 |   1 |   0 |  -1 |  -1 |   1 |   1 |   1 |   1 |      2 |          0 |      6 |          1 |           5 |           7 |         3 |             4 |
  | 6130c7f7d0112fa23b17079c |          2 |          0 |         -3 |   3 |   1 |   3 |  -3 |  -3 |  -3 |  -3 |  -1 |   1 |  -2 |  -1 |   1 |  -3 |  -2 |  -2 |  -2 |   0 |   2 |   4 |  -2 |   2 |  -1 |   2 |  -2 |   2 |   1 |   1 |   1 |   1 |   1 |   1 |  -1 |   1 |   1 |      1 |          5 |      0 |          2 |           6 |           4 |         3 |             7 |
  | 6023f94d1951e70ae21770ec |          1 |         -1 |         -3 |  -3 |  -3 |   3 |  -3 |  -3 |  -3 |  -2 |  -2 |  -1 |  -3 |   0 |   0 |  -1 |  -2 |  -2 |   0 |  -1 |  -1 |   5 |  -3 |  -3 |  -3 |  -2 |  -3 |  -1 |  -1 |  -3 |  -3 |  -3 |  -3 |  -2 |  -2 |  -1 |   1 |      0 |          2 |      1 |          3 |           7 |           4 |         5 |             6 |
  | 55d51a6b8ce09000127d4821 |          2 |          0 |         -3 |   0 |   1 |   1 |  -1 |  -3 |  -1 |  -2 |   0 |   2 |  -2 |  -1 |  -2 |  -3 |  -2 |   0 |  -1 |   0 |   1 |   3 |   2 |   0 |   0 |   1 |   0 |   1 |   1 |   2 |  -2 |  -2 |   0 |  -2 |   2 |  -3 |   1 |      3 |          1 |      0 |          2 |           5 |           6 |         7 |             4 |
  | 669a4f388b2de8df723faf1e |          1 |          0 |         -3 |   1 |   1 |   0 |  -1 |   1 |   0 |  -2 |  -2 |   0 |  -2 |  -2 |  -2 |  -2 |  -2 |   1 |   1 |  -3 |   3 |   2 |   3 |  -2 |   2 |   1 |   3 |   0 |   2 |  -2 |  -3 |  -3 |  -3 |  -3 |   3 |  -3 |   3 |      4 |          6 |      7 |          5 |           1 |           3 |         2 |             0 |
  | 6759fa50a9bb240e423de357 |          2 |         -1 |         -1 |   1 |   1 |  -1 |  -1 |  -1 |  -1 |  -3 |  -2 |   2 |   0 |  -1 |  -1 |  -1 |  -1 |  -1 |   0 |  -1 |   2 |   2 |   1 |   0 |   0 |  -1 |  -1 |  -1 |  -1 |  -1 |   0 |   0 |   0 |  -1 |   1 |   0 |   1 |      1 |          4 |      2 |          0 |           7 |           5 |         3 |             6 |
  | 66a7bf129cddb760981ebcec |          2 |         -3 |         -3 |   0 |  -3 |   3 |   1 |  -3 |  -3 |  -3 |  -3 |  -3 |  -3 |  -3 |  -3 |  -2 |  -2 |   2 |   2 |   0 |   3 |   3 |   2 |   0 |   2 |  -1 |   3 |   3 |   3 |   0 |  -3 |  -3 |  -3 |  -3 |   3 |  -3 |   4 |      1 |          3 |      0 |          2 |           4 |           7 |         6 |             5 |
  | 5f98099d48060d0450394002 |          1 |          0 |         -3 |   1 |  -1 |   3 |   1 |  -3 |  -3 |   1 |   0 |  -1 |   2 |   1 |   1 |   1 |   1 |   0 |  -1 |  -3 |   3 |   8 |   2 |  -2 |   1 |  -2 |   2 |  -2 |   1 |  -3 |  -2 |  -2 |  -2 |  -2 |   2 |  -2 |   1 |      0 |          6 |      1 |          2 |           3 |           4 |         5 |             7 |
  | 675b5e7290000cc3ac23d411 |          1 |          0 |         -3 |   1 |   1 |   1 |   1 |  -3 |  -3 |  -3 |  -1 |  -1 |  -1 |  -3 |  -2 |  -3 |  -3 |   3 |   3 |  -3 |   3 |   1 |   1 |   0 |   1 |  -1 |   1 |  -3 |  -3 |   1 |  -1 |  -1 |  -1 |  -1 |   1 |  -1 |   2 |      2 |          6 |      3 |          5 |           0 |           4 |         1 |             7 |
  | 5c4f7b99b33a5300013dbfdd |          2 |         -3 |         -3 |  -1 |  -1 |  -1 |  -3 |  -3 |  -1 |  -3 |  -3 |   2 |  -2 |  -3 |   1 |  -3 |  -3 |   1 |   1 |  -3 |   3 |   3 |   2 |  -1 |  -2 |  -3 |   1 |   1 |  -1 |   2 |   0 |  -1 |  -2 |  -1 |   2 |  -2 |   1 |      5 |          7 |      6 |          4 |           1 |           0 |         2 |             3 |
  | 67c4cf035a34c6ef254906e2 |          1 |          0 |          0 |   1 |   1 |   0 |   1 |   1 |   1 |   0 |   1 |   1 |   1 |   1 |   1 |   0 |   1 |   1 |   0 |   1 |   1 |   7 |   1 |   0 |   1 |   0 |   0 |   0 |   0 |   0 |   0 |   0 |   0 |   0 |   0 |   0 |   3 |      2 |          5 |      4 |          0 |           3 |           6 |         1 |             7 |
  | 60984a1b0cce76d16c4ca781 |          2 |         -3 |         -2 |  -3 |  -3 |  -3 |  -3 |  -3 |  -3 |  -3 |  -3 |   0 |  -2 |  -2 |  -3 |  -3 |  -3 |   0 |  -2 |  -2 |   0 |   3 |  -3 |  -3 |  -3 |  -2 |  -1 |  -1 |  -1 |  -1 |   0 |   0 |  -1 |  -2 |  -1 |   0 |   1 |      6 |          4 |      0 |          1 |           5 |           2 |         3 |             7 |
  | 66280e8f5cdc35202f29a49a |          1 |          0 |         -1 |   1 |   1 |  -1 |   1 |  -1 |   1 |  -2 |  -3 |   3 |  -2 |  -3 |   1 |  -2 |  -3 |   2 |   3 |  -3 |   3 |   2 |   2 |  -2 |   0 |   1 |   1 |  -3 |   1 |   1 |  -2 |  -3 |  -3 |   1 |   1 |  -1 |   4 |      7 |          6 |      4 |          5 |           1 |           0 |         3 |             2 |
  | 5ed9ee3afd7ffe59917d3dfa |          2 |          0 |         -3 |   1 |  -1 |  -3 |   0 |  -3 |  -3 |  -2 |  -2 |   1 |  -2 |  -2 |   1 |  -3 |  -2 |   1 |   1 |  -2 |   3 |   2 |   2 |  -2 |   2 |  -2 |   1 |  -1 |   1 |  -1 |  -2 |  -2 |  -2 |  -2 |   2 |  -2 |   2 |      4 |          6 |      5 |          7 |           0 |           1 |         2 |             3 |




** counts after filtering by attention checks
#+BEGIN_SRC R :var data=raw-attention :results value table :exports results :colnames yes
  suppressMessages({
    library(dplyr)
    library(tidyr)
  })
  df <- as.data.frame(data)
  out <- df %>% count(conditions)
  out[1,1] = "L"
  out[2,1] = "NL"
  out
#+END_SRC

#+RESULTS:
| conditions |  n |
|------------+----|
| L          | 16 |
| NL         | 15 |

* Warmth and competence
** data                                                           :noexport:

#+NAME: wc
#+BEGIN_SRC R :var data=raw-attention :results value table :exports results :colnames yes
  suppressMessages({
    library(dplyr)
    library(tidyr)
  })

  hex_degree <- function (r) {
    
  }

  df <- as.data.frame(data)
  out <- df %>% group_by(conditions) %>% mutate(r_sum_warm = r_kind + r_pleasant + r_warm + r_friendly,
                                                r_sum_competent = r_competent + r_effective + r_skilled + r_intellegent) %>% summarise(across(starts_with("r_"), list(mean = mean, sd = sd)))  %>%
  pivot_longer(-conditions, names_to = c("variable", ".value"), 
               names_pattern = "r_(.*)_(mean|sd)") %>%
  pivot_wider(names_from = conditions, values_from = c(mean, sd)) %>% 
  rename(L_m = mean_1, NL_m = mean_2, L_sd = sd_1, NL_sd = sd_2) %>%
  mutate(across(where(is.numeric), ~ format(round(.x, 2), nsmall = 2)))  
  ## mutate(degree = 0)  
  ## %>%
  ## mutate(across(where(is.numeric), ~ format(round(.x, 2), nsmall = 2))) ##  %>%
  ## ## rename(L_m = mean_1, NL_m = mean_2, L_sd = sd_1, NL_sd = sd_2)
  ## pivot_wider(names_from = conditions, values_from = mean_sd)
  #+END_SRC

  #+RESULTS: wc
  | variable      |   L_m |  NL_m | L_sd | NL_sd |
  |---------------+-------+-------+------+-------|
  | kind          |  2.62 |  2.93 | 2.16 |  2.31 |
  | pleasant      |  4.44 |  4.67 | 2.45 |  1.63 |
  | warm          |   3.0 |  2.33 | 2.31 |  2.38 |
  | friendly      |  3.62 |   3.4 | 2.06 |  2.26 |
  | competent     |  3.62 |  3.33 | 2.16 |  2.44 |
  | effective     |  4.25 |  3.87 | 1.84 |   2.5 |
  | skilled       |  2.44 |   3.4 |  2.1 |   2.2 |
  | intellegent   |   4.0 |  4.07 | 2.83 |  2.31 |
  | sum_warm      | 13.69 | 13.33 | 5.96 |  5.85 |
  | sum_competent | 14.31 | 14.67 | 5.96 |  5.85 |
** transposed table                                               :noexport:
 #+NAME: wc-t
    | variable |             kind |         pleasant |             warm | friendly |        competent |        effective | skilled |      intellegent |
    | L_m      |            2.625 |           4.4375 |                3 |    3.625 |            3.625 |             4.25 |  2.4375 |                4 |
    | NL_m     | 2.93333333333333 | 4.66666666666667 | 2.33333333333333 |      3.4 | 3.33333333333333 | 3.86666666666667 |     3.4 | 4.06666666666667 |
** spider plot
#+BEGIN_SRC gnuplot :var DATA=wc-t :file img/spider.svg :results file :exports results
  reset
  set datafile columnheader
  set spiderplot
  set for [i=1:8] paxis i range [0:5]
  set paxis 1 tics font ",10"
  set grid spiderplot
  plot for [i=2:9] DATA using i:key(1) title columnhead 
#+END_SRC

#+RESULTS:
[[file:img/spider.svg]]



* Kolmogorov-Smirnov & Shapiro Tests
- KS :: Tests whether or not two samples came from the same distribution.
- Shapiro :: Shapiro-Wilk test of normality.

#+BEGIN_SRC R :var data=raw-attention :results value table :exports results :colnames yes
  df <- as.data.frame(data)
  num_cols <- setdiff(names(df), c("prolific_pid", "conditions"))

  out <- lapply(num_cols, function(v) {
    ks <- try(ks.test(df[[v]] ~ df$conditions), silent = TRUE)
    shapiro <- try(shapiro.test(df[[v]]), silent = TRUE)
    data.frame(
      variable = v,
      KS_D = round(ks$statistic, 3),
      KS_p = paste(round(ks$p.value, 4), if(ks$p.value < 0.05) {"*"} else {""},  sep=""),
      Shapiro_W = round(shapiro$statistic, 3),
      Shapiro_p = round(shapiro$p.value, 4),
      Shapiro_normal = shapiro$p.value > 0.05
    )
  })
  do.call(rbind, out)
#+END_SRC

#+CAPTION: Kolmogorov-Smirnov & Shapiro Tests
#+RESULTS:
| variable      |  KS_D |    KS_p | Shapiro_W | Shapiro_p | Shapiro_normal |
|---------------+-------+---------+-----------+-----------+----------------|
| attention1    | 0.146 |  0.6816 |      0.79 |         0 | FALSE          |
| attention2    | 0.121 |  0.6885 |      0.51 |         0 | FALSE          |
| q1a           | 0.275 |  0.1331 |     0.749 |         0 | FALSE          |
| q1b           | 0.104 |  0.9144 |     0.857 |    0.0007 | FALSE          |
| q1c           | 0.217 |  0.4433 |     0.881 |    0.0025 | FALSE          |
| q1d           | 0.429 | 0.0477* |     0.855 |    0.0006 | FALSE          |
| q1e           | 0.312 |  0.1191 |     0.751 |         0 | FALSE          |
| q1f           | 0.117 |  0.8501 |     0.793 |         0 | FALSE          |
| q3a           | 0.183 |  0.6296 |     0.827 |    0.0002 | FALSE          |
| q3b           | 0.167 |  0.7387 |     0.913 |    0.0151 | FALSE          |
| q3c           | 0.146 |  0.8853 |     0.936 |    0.0623 | TRUE           |
| q3d           | 0.117 |  0.9683 |       0.9 |     0.007 | FALSE          |
| q3e           | 0.292 |  0.2845 |     0.923 |    0.0286 | FALSE          |
| q3f           | 0.138 |  0.8447 |     0.892 |    0.0046 | FALSE          |
| q3g           | 0.212 |  0.5586 |     0.887 |    0.0036 | FALSE          |
| q3h           | 0.162 |  0.7279 |     0.915 |    0.0172 | FALSE          |
| q3i           | 0.288 |  0.2444 |     0.929 |    0.0409 | FALSE          |
| q3j           | 0.288 |  0.2642 |     0.899 |     0.007 | FALSE          |
| q3k           | 0.183 |  0.6375 |     0.835 |    0.0003 | FALSE          |
| q3l           |  0.15 |  0.8463 |     0.849 |    0.0005 | FALSE          |
| q_6           | 0.221 |  0.6251 |     0.896 |    0.0057 | FALSE          |
| q7a           | 0.071 |  0.9856 |     0.781 |         0 | FALSE          |
| q7b           | 0.158 |  0.6846 |     0.915 |    0.0177 | FALSE          |
| q7c           | 0.079 |  0.9815 |     0.905 |    0.0097 | FALSE          |
| q7d           | 0.342 |  0.1378 |     0.889 |     0.004 | FALSE          |
| q7e           | 0.117 |  0.9461 |     0.947 |    0.1292 | TRUE           |
| q7f           | 0.088 |  0.9429 |     0.931 |    0.0456 | FALSE          |
| q7g           | 0.112 |  0.9366 |     0.934 |    0.0561 | TRUE           |
| q7h           | 0.171 |  0.6387 |      0.91 |    0.0126 | FALSE          |
| q7i           | 0.221 |  0.4558 |     0.929 |    0.0417 | FALSE          |
| q7j           |   0.1 |   0.926 |     0.902 |     0.008 | FALSE          |
| q7k           | 0.167 |  0.7412 |     0.929 |    0.0419 | FALSE          |
| q7l           | 0.242 |  0.3444 |     0.901 |    0.0079 | FALSE          |
| q7m           | 0.088 |  0.9631 |      0.92 |    0.0242 | FALSE          |
| q7n           |  0.15 |  0.7385 |     0.928 |    0.0391 | FALSE          |
| q_8           | 0.246 |   0.242 |     0.644 |         0 | FALSE          |
| r_kind        | 0.217 |  0.5876 |     0.905 |    0.0096 | FALSE          |
| r_pleasant    | 0.229 |  0.5045 |     0.883 |    0.0028 | FALSE          |
| r_warm        | 0.292 |  0.2958 |       0.9 |    0.0071 | FALSE          |
| r_friendly    | 0.233 |  0.5338 |     0.937 |    0.0661 | TRUE           |
| r_competent   |  0.15 |  0.8733 |     0.907 |    0.0108 | FALSE          |
| r_effective   | 0.275 |  0.3178 |     0.936 |    0.0644 | TRUE           |
| r_skilled     | 0.304 |  0.2594 |     0.925 |     0.033 | FALSE          |
| r_intellegent | 0.238 |  0.4826 |     0.881 |    0.0026 | FALSE          |

* Mann-Whitney- / t- test 

"Rate the discussion that you had with the AI agent."
#+BEGIN_SRC R :var data=raw-attention :results output verbatim :exports results
  df <- as.data.frame(data)

  wilcox.test(df$q_6 ~ df$conditions, mu = 5.5, correct = FALSE)
#+END_SRC

#+RESULTS:
: 
: 	Wilcoxon rank sum test
: 
: data:  df$q_6 by df$conditions
: W = 35, p-value = 0.0007504
: alternative hypothesis: true location shift is not equal to 5.5
: 

"Did you notice the agent laughing during the discussion?"
#+BEGIN_SRC R :var data=raw-attention :results output verbatim :exports results
  df <- as.data.frame(data)

  wilcox.test(df$q_8 ~ df$conditions, mu = 2.5, correct = FALSE)
  wilcox.test(df$q_8 ~ df$conditions, mu = 0, alternative = "greater", correct = FALSE)
#+END_SRC

#+RESULTS:
#+begin_example

	Wilcoxon rank sum test

data:  df$q_8 by df$conditions
W = 24, p-value = 7.391e-05
alternative hypothesis: true location shift is not equal to 2.5


	Wilcoxon rank sum test

data:  df$q_8 by df$conditions
W = 151, p-value = 0.06949
alternative hypothesis: true location shift is greater than 0

#+end_example


For Likert-scale  questions:
#+BEGIN_SRC R :var data=raw-attention :results value table :colnames yes :exports results
     df <- as.data.frame(data)
     df$conditions <- as.factor(df$conditions)

     qs <-  c(
    "q1a", "q1b", "q1c", "q1d", "q1e", "q1f",
    "q3a","q3b","q3c","q3d","q3e","q3f","q3g","q3h","q3i","q3j","q3k","q3l",
    "q7a","q7b","q7c","q7d","q7e","q7f","q7g","q7h","q7i","q7j","q7k","q7l","q7m","q7n")
       
     df[qs] <- lapply(df[qs], function(x) suppressWarnings(as.numeric(x)))

     out <- lapply(qs, function(v) {
       test <- try(wilcox.test(df[[v]] ~ df$conditions, mu = 0, correct = FALSE))
       test2 <- try(t.test(df[[v]] ~ df$conditions))
       if (inherits(test, "try-error")) return(NULL)
       data.frame(
         variable = v,
         mean_cond1 = round(mean(df[df$conditions == levels(df$conditions)[1], v], na.rm = TRUE), 2),
         mean_cond2 = round(mean(df[df$conditions == levels(df$conditions)[2], v], na.rm = TRUE), 2),
         W_wilcox = round(test$statistic, 3),
         p_wilcox = paste(round(test$p.value, 4), if(test$p.value < 0.05) {"*"} else {""},  sep=""),
         W_t = round(test2$statistic, 3),
         p_t = paste(round(test2$p.value, 4), if(test2$p.value < 0.05) {"*"} else {""},  sep="")
       )
     })
     do.call(rbind, out)
#+END_SRC

#+CAPTION: Statistical significance for Likert-scale questions
#+RESULTS:
| variable | mean_cond1 | mean_cond2 | W_wilcox | p_wilcox |    W_t |     p_t |
|----------+------------+------------+----------+----------+--------+---------|
| q1a      |        0.5 |       0.67 |      127 |   0.7459 | -0.307 |  0.7611 |
| q1b      |          0 |       0.33 |      107 |    0.586 |  -0.46 |  0.6491 |
| q1c      |       0.94 |      -0.13 |      152 |   0.1947 |   1.43 |   0.164 |
| q1d      |      -0.06 |      -1.47 |    170.5 |   0.038* |  2.135 | 0.0416* |
| q1e      |      -1.19 |       -2.2 |      152 |   0.1567 |  1.674 |  0.1068 |
| q1f      |      -1.38 |      -1.33 |      119 |   0.9666 |  -0.07 |  0.9449 |
| q3a      |       -0.5 |       -1.2 |      145 |   0.3098 |  0.982 |  0.3341 |
| q3b      |      -0.12 |       -0.6 |    137.5 |    0.483 |  0.667 |  0.5104 |
| q3c      |          0 |      -0.07 |    122.5 |   0.9204 |  0.097 |  0.9232 |
| q3d      |      -0.25 |      -0.47 |      130 |   0.6865 |  0.309 |  0.7597 |
| q3e      |      -0.06 |       -0.8 |      148 |   0.2613 |  1.125 |  0.2698 |
| q3f      |       0.12 |      -0.13 |      130 |   0.6826 |  0.387 |  0.7015 |
| q3g      |      -0.25 |         -1 |    146.5 |   0.2844 |  1.075 |  0.2911 |
| q3h      |      -0.44 |      -0.87 |    134.5 |   0.5604 |  0.652 |  0.5194 |
| q3i      |       0.12 |      -0.73 |      152 |   0.1999 |   1.27 |  0.2143 |
| q3j      |       0.19 |      -0.87 |      154 |   0.1712 |  1.464 |   0.154 |
| q3k      |      -1.25 |       -1.4 |      123 |   0.9024 |  0.266 |  0.7921 |
| q3l      |        1.5 |          1 |    134.5 |   0.5545 |  0.744 |   0.463 |
| q7a      |       0.88 |        0.8 |    119.5 |   0.9833 |  0.113 |  0.9108 |
| q7b      |         -1 |      -0.87 |      115 |   0.8383 | -0.267 |  0.7911 |
| q7c      |       0.31 |       0.13 |      128 |   0.7456 |    0.3 |  0.7662 |
| q7d      |      -0.25 |      -0.87 |      152 |   0.1898 |  1.212 |   0.237 |
| q7e      |       0.44 |       0.33 |    130.5 |   0.6704 |  0.188 |  0.8523 |
| q7f      |      -0.56 |      -0.27 |    110.5 |   0.7004 | -0.491 |   0.627 |
| q7g      |       0.62 |       0.47 |    129.5 |   0.7008 |  0.284 |  0.7784 |
| q7h      |      -0.31 |      -0.47 |      130 |    0.686 |  0.277 |  0.7837 |
| q7i      |         -1 |       -0.8 |    102.5 |   0.4757 | -0.433 |  0.6686 |
| q7j      |      -1.31 |      -1.07 |      106 |   0.5682 | -0.553 |  0.5842 |
| q7k      |      -1.25 |         -1 |      101 |   0.4411 | -0.528 |  0.6017 |
| q7l      |       -0.5 |       -1.2 |    151.5 |   0.1998 |  1.354 |  0.1863 |
| q7m      |       0.75 |       0.47 |      129 |   0.7123 |  0.532 |  0.5993 |
| q7n      |      -1.12 |      -1.07 |      118 |   0.9355 | -0.115 |  0.9093 |



* TODO Odds ratio
#+BEGIN_SRC R :var data=raw-attention :results value table :exports none :colnames yes
  suppressMessages({
    library(dplyr)
    library(tidyr)
    library(epitools)
  })
  df <- as.data.frame(data)
  df2 <- df %>% group_by(conditions) %>% summarise(across(where(is.numeric), list(mean = mean))) 
#+END_SRC

#+RESULTS:
| conditions | attention1_mean |   attention2_mean |          q1a_mean |          q1b_mean |           q1c_mean |          q1d_mean | q1e_mean |          q1f_mean | q3a_mean | q3b_mean |            q3c_mean |           q3d_mean | q3e_mean |           q3f_mean | q3g_mean |           q3h_mean |           q3i_mean |           q3j_mean | q3k_mean | q3l_mean | q_6_mean | q7a_mean |           q7b_mean |          q7c_mean |           q7d_mean |          q7e_mean |           q7f_mean |          q7g_mean |           q7h_mean | q7i_mean |          q7j_mean | q7k_mean | q7l_mean |          q7m_mean |          q7n_mean |         q_8_mean |      r_kind_mean |  r_pleasant_mean |      r_warm_mean | r_friendly_mean | r_competent_mean | r_effective_mean | r_skilled_mean | r_intellegent_mean |
|------------+-----------------+-------------------+-------------------+-------------------+--------------------+-------------------+----------+-------------------+----------+----------+---------------------+--------------------+----------+--------------------+----------+--------------------+--------------------+--------------------+----------+----------+----------+----------+--------------------+-------------------+--------------------+-------------------+--------------------+-------------------+--------------------+----------+-------------------+----------+----------+-------------------+-------------------+------------------+------------------+------------------+------------------+-----------------+------------------+------------------+----------------+--------------------|
|          1 |         -0.8125 |           -2.5625 |               0.5 |                 0 |             0.9375 |           -0.0625 |  -1.1875 |            -1.375 |     -0.5 |   -0.125 |                   0 |              -0.25 |  -0.0625 |              0.125 |    -0.25 |            -0.4375 |              0.125 |             0.1875 |    -1.25 |      1.5 |   5.5625 |    0.875 |                 -1 |            0.3125 |              -0.25 |            0.4375 |            -0.5625 |             0.625 |            -0.3125 |       -1 |           -1.3125 |    -1.25 |     -0.5 |              0.75 |            -1.125 |            1.875 |            2.625 |           4.4375 |                3 |           3.625 |            3.625 |             4.25 |         2.4375 |                  4 |
|          2 |            -0.8 | -2.73333333333333 | 0.666666666666667 | 0.333333333333333 | -0.133333333333333 | -1.46666666666667 |     -2.2 | -1.33333333333333 |     -1.2 |     -0.6 | -0.0666666666666667 | -0.466666666666667 |     -0.8 | -0.133333333333333 |       -1 | -0.866666666666667 | -0.733333333333333 | -0.866666666666667 |     -1.4 |        1 |      4.8 |      0.8 | -0.866666666666667 | 0.133333333333333 | -0.866666666666667 | 0.333333333333333 | -0.266666666666667 | 0.466666666666667 | -0.466666666666667 |     -0.8 | -1.06666666666667 |       -1 |     -1.2 | 0.466666666666667 | -1.06666666666667 | 1.33333333333333 | 2.93333333333333 | 4.66666666666667 | 2.33333333333333 |             3.4 | 3.33333333333333 | 3.86666666666667 |            3.4 |   4.06666666666667 |



* Plots
#+NAME: freqdata
#+BEGIN_SRC R :var data=raw-attention :results value table :colnames yes :exports none
suppressMessages({
  library(dplyr)
  library(tidyr)
})
df <- as.data.frame(data, stringsAsFactors = FALSE)
qs <- c("q3a","q3b","q3c","q3d","q3e","q3f","q3g","q3h","q3i","q3j","q3k","q3l", "q_6", "q_8", "q1d")
df[qs] <- lapply(df[qs], function(x) suppressWarnings(as.numeric(x)))

df %>%
  select(conditions, all_of(qs)) %>%
  tidyr::pivot_longer(cols = all_of(qs), names_to = "question", values_to = "score") %>%
group_by(conditions, question, score)%>%
  summarise(freq = n(), .groups = "drop") %>%
  tidyr::pivot_wider(
    id_cols = c(question, score),
    names_from = conditions,
    values_from = freq,
    names_prefix = "cond",
    values_fill = 0
  ) %>%
  arrange(question, score)
#+END_SRC

#+NAME: freqdata
#+RESULTS: freqdata
| question | score | cond1 | cond2 |
|----------+-------+-------+-------|
| q1d      |    -3 |     4 |     7 |
| q1d      |    -1 |     2 |     3 |
| q1d      |     0 |     1 |     3 |
| q1d      |     1 |     7 |     2 |
| q1d      |     3 |     2 |     0 |
| q3a      |    -3 |     4 |     6 |
| q3a      |    -2 |     3 |     3 |
| q3a      |     0 |     3 |     1 |
| q3a      |     1 |     2 |     4 |
| q3a      |     2 |     4 |     1 |
| q3b      |    -3 |     2 |     4 |
| q3b      |    -2 |     3 |     2 |
| q3b      |    -1 |     2 |     2 |
| q3b      |     0 |     1 |     2 |
| q3b      |     1 |     5 |     2 |
| q3b      |     2 |     2 |     2 |
| q3b      |     3 |     1 |     1 |
| q3c      |    -3 |     1 |     2 |
| q3c      |    -2 |     2 |     3 |
| q3c      |    -1 |     5 |     1 |
| q3c      |     0 |     2 |     2 |
| q3c      |     1 |     2 |     3 |
| q3c      |     2 |     2 |     3 |
| q3c      |     3 |     2 |     1 |
| q3d      |    -3 |     2 |     2 |
| q3d      |    -2 |     4 |     5 |
| q3d      |    -1 |     2 |     0 |
| q3d      |     0 |     1 |     2 |
| q3d      |     1 |     3 |     4 |
| q3d      |     2 |     3 |     1 |
| q3d      |     3 |     1 |     1 |
| q3e      |    -3 |     3 |     3 |
| q3e      |    -2 |     1 |     2 |
| q3e      |    -1 |     2 |     5 |
| q3e      |     0 |     3 |     1 |
| q3e      |     1 |     3 |     2 |
| q3e      |     2 |     3 |     2 |
| q3e      |     3 |     1 |     0 |
| q3f      |    -3 |     1 |     3 |
| q3f      |    -2 |     4 |     1 |
| q3f      |    -1 |     0 |     2 |
| q3f      |     0 |     2 |     1 |
| q3f      |     1 |     6 |     6 |
| q3f      |     2 |     2 |     1 |
| q3f      |     3 |     1 |     1 |
| q3g      |    -3 |     3 |     6 |
| q3g      |    -2 |     2 |     1 |
| q3g      |    -1 |     1 |     1 |
| q3g      |     0 |     4 |     3 |
| q3g      |     1 |     3 |     2 |
| q3g      |     2 |     2 |     2 |
| q3g      |     3 |     1 |     0 |
| q3h      |    -3 |     3 |     3 |
| q3h      |    -2 |     3 |     4 |
| q3h      |    -1 |     1 |     2 |
| q3h      |     0 |     3 |     2 |
| q3h      |     1 |     4 |     2 |
| q3h      |     2 |     1 |     2 |
| q3h      |     3 |     1 |     0 |
| q3i      |    -3 |     2 |     3 |
| q3i      |    -2 |     2 |     3 |
| q3i      |    -1 |     1 |     3 |
| q3i      |     0 |     3 |     2 |
| q3i      |     1 |     5 |     2 |
| q3i      |     2 |     1 |     1 |
| q3i      |     3 |     2 |     1 |
| q3j      |    -3 |     2 |     4 |
| q3j      |    -2 |     2 |     4 |
| q3j      |    -1 |     1 |     1 |
| q3j      |     0 |     3 |     1 |
| q3j      |     1 |     5 |     3 |
| q3j      |     2 |     0 |     1 |
| q3j      |     3 |     3 |     1 |
| q3k      |    -3 |     7 |     4 |
| q3k      |    -2 |     1 |     4 |
| q3k      |    -1 |     1 |     2 |
| q3k      |     0 |     3 |     4 |
| q3k      |     1 |     4 |     1 |
| q3l      |    -3 |     0 |     1 |
| q3l      |    -2 |     1 |     1 |
| q3l      |    -1 |     2 |     2 |
| q3l      |     0 |     1 |     2 |
| q3l      |     1 |     2 |     1 |
| q3l      |     2 |     4 |     3 |
| q3l      |     3 |     6 |     5 |
| q_6      |     1 |     2 |     1 |
| q_6      |     2 |     3 |     2 |
| q_6      |     3 |     0 |     4 |
| q_6      |     4 |     0 |     1 |
| q_6      |     5 |     2 |     1 |
| q_6      |     6 |     2 |     1 |
| q_6      |     7 |     1 |     2 |
| q_6      |     8 |     2 |     1 |
| q_6      |     9 |     4 |     2 |
| q_8      |     1 |     9 |    12 |
| q_8      |     2 |     2 |     2 |
| q_8      |     3 |     3 |     0 |
| q_8      |     4 |     2 |     1 |

** ASA [cite:@fitrianie_artificial-social-agent_2022]
#+BEGIN_SRC gnuplot :var freq=freqdata :file img/asa-histograms.svg :results file graphics :exports results
  reset
    set term svg mouse size 1000,700
    # set term pdfcairo font "Helvetica,6"
    set multiplot layout 3,4 title ""
    set boxwidth 0.9
    set yrange [0:9]
    set ylabel "Frequency"
    questions = "q3a q3b q3c q3d q3e q3f q3g q3h q3i q3j q3k q3l"
  set tics nomirror
  set style line 5 lt -1 lw 0.5
  set border 3 ls 5
  set xtics ls 0
  # set style data histograms
  # set style histogram clustered gap 1


    # Parallel array of human-readable labels (same order as vars)
  array titles[12]
  titles[1] = "The agent has a human-like manner"
  titles[2] = "I like the agent"
  titles[3] = "The agent is boring"
  titles[4] = "The interaction captured my attention"
  titles[5] = "The agent does its task well"
  titles[6] = "The agent interacts socially with me"
  titles[7] = "I will use the agent again in the future"
  titles[8] = "I can rely on the agent"
  titles[9] = "The agentâ€™s behavior does not make sense"
  titles[10] = "The agent has no clue of what it is doing"
  titles[11] = "The agent is a social entity"
  titles[12] = "The agent is emotionless"

  do for [i=1:words(questions)] {
      v = word(questions,i)
      set xlabel v." ".titles[i]
      set xrange [-3.9:3.9]
      set style fill solid 
      set boxwidth 0.3 abs
      xcoord(k) =  (k == 1 ? -0.15 : 0.15) + (strcol(1) eq v ? column(2): 1/0)
      plot for [k=1:2] \
        freq using (xcoord(k)):(column(k+2)) with boxes title (k==1?"L":"NL") lw 0
  }
      
    # do for [i=1:words(questions)] {
    #     v = word(questions,i)
    #     set xlabel titles[i]
    #         set xrange [-3:3]
    #     plot freq using (strcol(1) eq v ? column(3): 1/0 ), '' using (strcol(1) eq v ? column(4): 1/0 ):xtic(2)
    #     # plot for [k=1:2] \
    #     #   freq using (strcol(1) eq v ? (k+1): 1/0 ): xticlabels(2)
    # }
    unset multiplot
#+END_SRC

#+ATTR_LATEX: :options pretex=\fontsize{6}{4}\sffamily :width \linewidth
#+RESULTS:
[[file:img/asa-histograms.svg]]

** rate discussion / noticing laughters 
#+BEGIN_SRC gnuplot :var freq=freqdata :file img/like-laugh-histograms.svg :results file graphics :exports results
    reset
      # set term pdfcairo font "Helvetica,7"
      # set term svg mouse size 800,600
      set multiplot layout 1,2 title ""
      set boxwidth 0.9
      set ylabel "Frequency"
      questions = "q_6 q_8"
    set tics nomirror
    set style line 5 lt -1 lw 0.5
    set border 3 ls 5
    set xtics ls 0
    # set style data histograms
    # set style histogram clustered gap 1


        set style fill solid 
        set boxwidth 0.3 abs
          xcoord(k,v) =  (k == 1 ? -0.15 : 0.15) + (strcol(1) eq v ? column(2): 1/0)


  set xlabel "Rate the discussion that you had with the AI agent."
    set xrange [0:11]
        set yrange [0:6]
    plot for [k=1:2] \
         freq using (xcoord(k,"q_6")):(column(k+2)) with boxes title (k==1?"L":"NL") lw 0

    set xlabel "Did you notice the agent laughing during the discussion?"
    set xrange [0:5]
          set yrange [0:15]

    plot for [k=1:2] \
         freq using (xcoord(k, "q_8")):(column(k+2)) with boxes title (k==1?"L":"NL") lw 0

    unset multiplot
#+END_SRC
#+ATTR_LATEX: :options pretex=\fontsize{6}{4}\sffamily :width \linewidth
#+RESULTS:
[[file:img/like-laugh-histograms.svg]]


** COMMENT TBD mean / std

#+NAME: means
#+BEGIN_SRC R :var data=raw-attention :results value table :exports results :colnames yes
  suppressMessages({
    library(dplyr)
    library(tidyr)
    library(epitools)
  })
  df <- as.data.frame(data)
  df2 <- df %>% group_by(conditions) %>% summarise(across(where(is.numeric), list(mean = mean))) 
#+END_SRC

#+RESULTS: means
| conditions | attention1_mean |   attention2_mean |          q1a_mean |          q1b_mean |           q1c_mean |          q1d_mean | q1e_mean |          q1f_mean | q3a_mean | q3b_mean |            q3c_mean |           q3d_mean | q3e_mean |           q3f_mean | q3g_mean |           q3h_mean |           q3i_mean |           q3j_mean | q3k_mean | q3l_mean | q_6_mean | q7a_mean |           q7b_mean |          q7c_mean |           q7d_mean |          q7e_mean |           q7f_mean |          q7g_mean |           q7h_mean | q7i_mean |          q7j_mean | q7k_mean | q7l_mean |          q7m_mean |          q7n_mean |         q_8_mean |      r_kind_mean |  r_pleasant_mean |      r_warm_mean | r_friendly_mean | r_competent_mean | r_effective_mean | r_skilled_mean | r_intellegent_mean |
|------------+-----------------+-------------------+-------------------+-------------------+--------------------+-------------------+----------+-------------------+----------+----------+---------------------+--------------------+----------+--------------------+----------+--------------------+--------------------+--------------------+----------+----------+----------+----------+--------------------+-------------------+--------------------+-------------------+--------------------+-------------------+--------------------+----------+-------------------+----------+----------+-------------------+-------------------+------------------+------------------+------------------+------------------+-----------------+------------------+------------------+----------------+--------------------|
|          1 |         -0.8125 |           -2.5625 |               0.5 |                 0 |             0.9375 |           -0.0625 |  -1.1875 |            -1.375 |     -0.5 |   -0.125 |                   0 |              -0.25 |  -0.0625 |              0.125 |    -0.25 |            -0.4375 |              0.125 |             0.1875 |    -1.25 |      1.5 |   5.5625 |    0.875 |                 -1 |            0.3125 |              -0.25 |            0.4375 |            -0.5625 |             0.625 |            -0.3125 |       -1 |           -1.3125 |    -1.25 |     -0.5 |              0.75 |            -1.125 |            1.875 |            2.625 |           4.4375 |                3 |           3.625 |            3.625 |             4.25 |         2.4375 |                  4 |
|          2 |            -0.8 | -2.73333333333333 | 0.666666666666667 | 0.333333333333333 | -0.133333333333333 | -1.46666666666667 |     -2.2 | -1.33333333333333 |     -1.2 |     -0.6 | -0.0666666666666667 | -0.466666666666667 |     -0.8 | -0.133333333333333 |       -1 | -0.866666666666667 | -0.733333333333333 | -0.866666666666667 |     -1.4 |        1 |      4.8 |      0.8 | -0.866666666666667 | 0.133333333333333 | -0.866666666666667 | 0.333333333333333 | -0.266666666666667 | 0.466666666666667 | -0.466666666666667 |     -0.8 | -1.06666666666667 |       -1 |     -1.2 | 0.466666666666667 | -1.06666666666667 | 1.33333333333333 | 2.93333333333333 | 4.66666666666667 | 2.33333333333333 |             3.4 | 3.33333333333333 | 3.86666666666667 |            3.4 |   4.06666666666667 |

#+BEGIN_SRC gnuplot :var means=means :file means.svg :results file graphics
  reset
  set style data histograms
  plot means with boxes

#+END_SRC

#+RESULTS:
[[file:means.svg]]



* COMMENT Recordings 

** COMMENT scp them
#+begin_src bash :results drawer :var tbl=raw
  mkdir -p recordings
  for idx in ${!tbl[*]}; do
    echo "Downloading $idx"
    scp "rndserv:/srv/data/xmarvl/oeuvre-recordings/*$idx*" recordings/
  done
#+end_src

#+RESULTS:
:results:
52070bf9-8e3f-4e65-baf6-428a1e6a3fb6
:end:


#+begin_src bash :results drawer :var tbl=raw-attention :colnames yes :dir recordings/raw :colnames yes :session a12345 
  for idx in ${!tbl[*]}; do
      echo -n "$idx";
      while read line; do
          ./merge_convert_align.sh $idx $line
          break;
      done  <<<${tbl[$idx]}
      echo
  done
#+end_src



#+RESULTS:
:results:
55d51a6b8ce09000127d4821Found files:
  Screen: x_screen_55d51a6b8ce09000127d4821_6b7343fd-3469-4089-b056-ad36ea85ed2a.mp4
  Mic:    x_mic_55d51a6b8ce09000127d4821_6b7343fd-3469-4089-b056-ad36ea85ed2a.mp4
  Output: 55d51a6b8ce09000127d4821_2.wav

5c4f7b99b33a5300013dbfddFound files:
  Screen: x_screen_5c4f7b99b33a5300013dbfdd_5a93c029-8048-4768-87b3-7540590c3074.mp4
  Mic:    x_mic_5c4f7b99b33a5300013dbfdd_5a93c029-8048-4768-87b3-7540590c3074.mp4
  Output: 5c4f7b99b33a5300013dbfdd_2.wav
ob_comint_async_shell_end_770d11ca-fe38-4c4c-8e7c-85ce31020fde
5f98099d48060d0450394002Found files:
  Screen: x_screen_5f98099d48060d0450394002_c54edd5b-9862-4f02-a9be-a820ac663b2b.mp4
  Mic:    x_mic_5f98099d48060d0450394002_c54edd5b-9862-4f02-a9be-a820ac663b2b.mp4
  Output: 5f98099d48060d0450394002_1.wav

5d8cef3c28e183001a335ab0Found files:
  Screen: x_screen_5d8cef3c28e183001a335ab0_2d74f4aa-32c9-4a04-9cb9-1b41b2043f75.mp4
  Mic:    x_mic_5d8cef3c28e183001a335ab0_2d74f4aa-32c9-4a04-9cb9-1b41b2043f75.mp4
  Output: 5d8cef3c28e183001a335ab0_1.wav

5d403b7d4e509a0019f664f0Found files:
  Screen: x_screen_5d403b7d4e509a0019f664f0_cee7d22b-6534-4872-a9b9-95e4fbff571b.mp4
  Mic:    x_mic_5d403b7d4e509a0019f664f0_cee7d22b-6534-4872-a9b9-95e4fbff571b.mp4
  Output: 5d403b7d4e509a0019f664f0_1.wav

5ed9ee3afd7ffe59917d3dfaFound files:
  Screen: x_screen_5ed9ee3afd7ffe59917d3dfa_934fc324-16ee-4dc0-8ae4-6ece4cd57bb3.mp4
  Mic:    x_mic_5ed9ee3afd7ffe59917d3dfa_934fc324-16ee-4dc0-8ae4-6ece4cd57bb3.mp4
  Output: 5ed9ee3afd7ffe59917d3dfa_2.wav

60984a1b0cce76d16c4ca781Found files:
  Screen: x_screen_60984a1b0cce76d16c4ca781_b8e224f2-7c88-4b9c-9778-4c78e77f9329.mp4
  Mic:    x_mic_60984a1b0cce76d16c4ca781_b8e224f2-7c88-4b9c-9778-4c78e77f9329.mp4
  Output: 60984a1b0cce76d16c4ca781_2.wav

6773d42d35be03a65cf4b3e1Found files:
  Screen: x_screen_6773d42d35be03a65cf4b3e1_02cc7f61-7dea-44fd-a473-700889a7e283.mp4
  Mic:    x_mic_6773d42d35be03a65cf4b3e1_02cc7f61-7dea-44fd-a473-700889a7e283.mp4
  Output: 6773d42d35be03a65cf4b3e1_2.wav

66a7bf129cddb760981ebcecFound files:
  Screen: x_screen_66a7bf129cddb760981ebcec_264b76b7-5eea-4e6d-8040-42ba9f8686f6.mp4
  Mic:    x_mic_66a7bf129cddb760981ebcec_264b76b7-5eea-4e6d-8040-42ba9f8686f6.mp4
  Output: 66a7bf129cddb760981ebcec_2.wav

5ec96e3609117f0a67231842Found files:
  Screen: x_screen_5ec96e3609117f0a67231842_a0ba8868-0d4d-4cb9-8dab-dcbc2ea2592f.mp4
  Mic:    x_mic_5ec96e3609117f0a67231842_a0ba8868-0d4d-4cb9-8dab-dcbc2ea2592f.mp4
  Output: 5ec96e3609117f0a67231842_1.wav

5f39a2fd2d394917284dd66fFound files:
  Screen: x_screen_5f39a2fd2d394917284dd66f_32d7de36-0a47-4635-9868-2a2be0bbd580.mp4
  Mic:    x_mic_5f39a2fd2d394917284dd66f_32d7de36-0a47-4635-9868-2a2be0bbd580.mp4
  Output: 5f39a2fd2d394917284dd66f_2.wav

67155cf3f170705a5fe7a1a1Found files:
  Screen: x_screen_67155cf3f170705a5fe7a1a1_2fb62bd6-fd12-4ea1-8a7b-363f2eaf9b22.mp4
  Mic:    x_mic_67155cf3f170705a5fe7a1a1_2fb62bd6-fd12-4ea1-8a7b-363f2eaf9b22.mp4
  Output: 67155cf3f170705a5fe7a1a1_2.wav

5b90635a877eab0001d7ba9eFound files:
  Screen: x_screen_5b90635a877eab0001d7ba9e_3b830d38-0531-4de8-acd2-974f8418cae9.mp4
  Mic:    x_mic_5b90635a877eab0001d7ba9e_3b830d38-0531-4de8-acd2-974f8418cae9.mp4
  Output: 5b90635a877eab0001d7ba9e_1.wav
[0;35m[mov,mp4,m4a,3gp,3g2,mj2 @ 0x819098000] [0m[1;31mmoov atom not found
[0m[1;31mx_screen_5b90635a877eab0001d7ba9e_3b830d38-0531-4de8-acd2-974f8418cae9.mp4: Invalid data found when processing input
[0m
6759fa50a9bb240e423de357Found files:
  Screen: x_screen_6759fa50a9bb240e423de357_503ad01a-8ad6-422b-af6b-1e89c94b8ead.mp4
  Mic:    x_mic_6759fa50a9bb240e423de357_503ad01a-8ad6-422b-af6b-1e89c94b8ead.mp4
  Output: 6759fa50a9bb240e423de357_2.wav

5bbb5e3f118c0600013c3202Found files:
  Screen: x_screen_5bbb5e3f118c0600013c3202_35579840-effa-4215-9471-6690f5fdb722.mp4
  Mic:    x_mic_5bbb5e3f118c0600013c3202_35579840-effa-4215-9471-6690f5fdb722.mp4
  Output: 5bbb5e3f118c0600013c3202_1.wav

6612990fa0e1d2605331a833Found files:
  Screen: x_screen_6612990fa0e1d2605331a833_c4ba380b-3767-47a6-896d-c1d4d1177d56.mp4
  Mic:    x_mic_6612990fa0e1d2605331a833_c4ba380b-3767-47a6-896d-c1d4d1177d56.mp4
  Output: 6612990fa0e1d2605331a833_2.wav

66d1fdd400acfdbc181f41e0Found files:
  Screen: x_screen_66d1fdd400acfdbc181f41e0_320c06f7-a6d6-4904-aaec-a96957398e60.mp4
  Mic:    x_mic_66d1fdd400acfdbc181f41e0_320c06f7-a6d6-4904-aaec-a96957398e60.mp4
  Output: 66d1fdd400acfdbc181f41e0_1.wav

66280e8f5cdc35202f29a49aFound files:
  Screen: x_screen_66280e8f5cdc35202f29a49a_ad4a151c-1b02-4dd1-9343-1a4a4a01ab1b.mp4
  Mic:    x_mic_66280e8f5cdc35202f29a49a_ad4a151c-1b02-4dd1-9343-1a4a4a01ab1b.mp4
  Output: 66280e8f5cdc35202f29a49a_1.wav

67c4cf035a34c6ef254906e2Found files:
  Screen: x_screen_67c4cf035a34c6ef254906e2_1953160c-ebfe-4d60-9d13-83306eb4d9c4.mp4
  Mic:    x_mic_67c4cf035a34c6ef254906e2_1953160c-ebfe-4d60-9d13-83306eb4d9c4.mp4
  Output: 67c4cf035a34c6ef254906e2_1.wav
[0;35m[mov,mp4,m4a,3gp,3g2,mj2 @ 0xbf9074000] [0m[1;31mmoov atom not found
[0m[1;31mx_screen_67c4cf035a34c6ef254906e2_1953160c-ebfe-4d60-9d13-83306eb4d9c4.mp4: Invalid data found when processing input
[0m
675b5e7290000cc3ac23d411Found files:
  Screen: x_screen_675b5e7290000cc3ac23d411_31d70248-c3c2-41fd-b383-0491286acd62.mp4
  Mic:    x_mic_675b5e7290000cc3ac23d411_31d70248-c3c2-41fd-b383-0491286acd62.mp4
  Output: 675b5e7290000cc3ac23d411_1.wav

5cfccc437189a800011a3606Found files:
  Screen: x_screen_5cfccc437189a800011a3606_a5927579-ccb2-4e83-b4cc-deae83ba8f3f.mp4
  Mic:    x_mic_5cfccc437189a800011a3606_a5927579-ccb2-4e83-b4cc-deae83ba8f3f.mp4
  Output: 5cfccc437189a800011a3606_1.wav

5f3ec93efbd299158253f283Found files:
  Screen: x_screen_5f3ec93efbd299158253f283_68046d3e-1976-4e47-8db7-4ad8a40057eb.mp4
  Mic:    x_mic_5f3ec93efbd299158253f283_68046d3e-1976-4e47-8db7-4ad8a40057eb.mp4
  Output: 5f3ec93efbd299158253f283_2.wav

65651805d1afb42ba1a55476Found files:
  Screen: x_screen_65651805d1afb42ba1a55476_4cb4ac49-44f6-4506-939c-c66c36895716.mp4
  Mic:    x_mic_65651805d1afb42ba1a55476_4cb4ac49-44f6-4506-939c-c66c36895716.mp4
  Output: 65651805d1afb42ba1a55476_2.wav

66015f3971c6f69214564a4fFound files:
  Screen: x_screen_66015f3971c6f69214564a4f_f88241be-3dc4-4d4b-ab65-761753420ea7.mp4
  Mic:    x_mic_66015f3971c6f69214564a4f_f88241be-3dc4-4d4b-ab65-761753420ea7.mp4
  Output: 66015f3971c6f69214564a4f_1.wav

669a4f388b2de8df723faf1eFound files:
  Screen: x_screen_669a4f388b2de8df723faf1e_35d6bba1-19d7-4bc2-9cc0-543199401c7b.mp4
  Mic:    x_mic_669a4f388b2de8df723faf1e_35d6bba1-19d7-4bc2-9cc0-543199401c7b.mp4
  Output: 669a4f388b2de8df723faf1e_1.wav

6130c7f7d0112fa23b17079cFound files:
  Screen: x_screen_6130c7f7d0112fa23b17079c_d8760c3d-c768-4433-94af-fd823a17f857.mp4
  Mic:    x_mic_6130c7f7d0112fa23b17079c_d8760c3d-c768-4433-94af-fd823a17f857.mp4
  Output: 6130c7f7d0112fa23b17079c_2.wav

6023f94d1951e70ae21770ecFound files:
  Screen: x_screen_6023f94d1951e70ae21770ec_b6c1caef-29d7-4584-af1d-e6a10adf57ef.mp4
  Mic:    x_mic_6023f94d1951e70ae21770ec_b6c1caef-29d7-4584-af1d-e6a10adf57ef.mp4
  Output: 6023f94d1951e70ae21770ec_1.wav

586fabdf2bd3c900018599a9Found files:
  Screen: x_screen_586fabdf2bd3c900018599a9_faae3911-e12f-4394-8cd1-2ea0b8d50d35.mp4
  Mic:    x_mic_586fabdf2bd3c900018599a9_faae3911-e12f-4394-8cd1-2ea0b8d50d35.mp4
  Output: 586fabdf2bd3c900018599a9_2.wav

5ee5defbfe74a3000d106f51Found files:
  Screen: x_screen_5ee5defbfe74a3000d106f51_60f69025-53e0-4b3b-abfd-d5a823116e84.mp4
  Mic:    x_mic_5ee5defbfe74a3000d106f51_60f69025-53e0-4b3b-abfd-d5a823116e84.mp4
  Output: 5ee5defbfe74a3000d106f51_1.wav

67803b5508f3d995ef13696bFound files:
  Screen: x_screen_67803b5508f3d995ef13696b_39964dcc-061e-494d-8f8c-7eb348469f66.mp4
  Mic:    x_mic_67803b5508f3d995ef13696b_39964dcc-061e-494d-8f8c-7eb348469f66.mp4
  Output: 67803b5508f3d995ef13696b_2.wav

68b75e854acbece78d1301abFound files:
  Screen: x_screen_68b75e854acbece78d1301ab_92b4739c-3552-428f-b783-abb1378a34c6.mp4
  Mic:    x_mic_68b75e854acbece78d1301ab_92b4739c-3552-428f-b783-abb1378a34c6.mp4
  Output: 68b75e854acbece78d1301ab_1.wav

55d51a6b8ce09000127d4821Found files:
  Screen: x_screen_55d51a6b8ce09000127d4821_6b7343fd-3469-4089-b056-ad36ea85ed2a.mp4
  Mic:    x_mic_55d51a6b8ce09000127d4821_6b7343fd-3469-4089-b056-ad36ea85ed2a.mp4
  Output: 55d51a6b8ce09000127d4821_2.wav

5c4f7b99b33a5300013dbfddFound files:
  Screen: x_screen_5c4f7b99b33a5300013dbfdd_5a93c029-8048-4768-87b3-7540590c3074.mp4
  Mic:    x_mic_5c4f7b99b33a5300013dbfdd_5a93c029-8048-4768-87b3-7540590c3074.mp4
  Output: 5c4f7b99b33a5300013dbfdd_2.wav
:end:



** 

* COMMENT Attic
** COMMENT QQ plots
#+BEGIN_SRC R :var data=raw :results output :exports both
# Make a QQ-plot PNG for every Likert-ish column (values within [-3, 3])
df <- as.data.frame(data, stringsAsFactors = FALSE)

# columns to ignore
ignore <- c("prolific_pid", "conditions")

# coerce everything else; keep NAs if non-numeric
cand <- setdiff(names(df), ignore)
df[cand] <- lapply(df[cand], function(x) suppressWarnings(as.numeric(x)))

# detect Likert-ish columns automatically (all non-NA values between -3 and 3)
is_likert <- function(x) {
  x <- x[!is.na(x)]
  length(x) > 2 && all(x >= -3 & x <= 3)
}
likert_cols <- cand[vapply(df[cand], is_likert, logical(1))]

# create output dir
outdir <- "likert_qq"
if (!dir.exists(outdir)) dir.create(outdir)

# generate one QQ-plot PNG per item
for (v in likert_cols) {
  x <- df[[v]]
  x <- x[!is.na(x)]
  if (length(unique(x)) < 3) next  # need a few distinct values for a meaningful QQ-plot
  png(filename = file.path(outdir, paste0("qq_", v, ".png")), width = 800, height = 600, res = 120)
  qqnorm(x, main = paste("QQ-plot:", v), ylab = "Sample Quantiles", xlab = "Theoretical Quantiles")
  qqline(x)
  dev.off()
}

cat("Wrote", length(likert_cols), "QQ-plots to", outdir, "\n")
#+END_SRC

#+RESULTS:
: Wrote 34 QQ-plots to likert_qq 

#+BEGIN_SRC R :var data=raw :results output :exports both
df <- as.data.frame(data, stringsAsFactors = FALSE)
qs <- c("q1a","q1b","q1c","q1d","q1e","q1f")

# Make sure theyâ€™re numeric
df[qs] <- lapply(df[qs], function(x) suppressWarnings(as.numeric(x)))

# Output directory
outdir <- "scatterplots_svg"
if (!dir.exists(outdir)) dir.create(outdir)

# Generate one scatterplot SVG per pair
for (i in 1:(length(qs)-1)) {
  x <- qs[i]
  y <- qs[i+1]
  fname <- file.path(outdir, paste0("scatter_", x, "_vs_", y, ".svg"))
  svg(fname, width = 6, height = 4)
  plot(df[[x]], df[[y]],
       main = paste("Scatterplot:", x, "vs", y),
       xlab = x, ylab = y,
       pch = 19, col = "steelblue")
  abline(lm(df[[y]] ~ df[[x]]), col = "red", lwd = 2)
  dev.off()
}
cat("Wrote scatterplots to", outdir, "\n")
#+END_SRC



** COMMENT Linear mixed effects

#+BEGIN_SRC R :var data=raw :results output verbatim
    suppressMessages({
      library(dplyr)
      library(tidyr)
      library(lme4)
      ## library(broom.mixed)
    })

    # Start with your data prep
    df <- as.data.frame(data, stringsAsFactors = FALSE)
    df$conditions <- as.factor(df$conditions)

    qs <- c("q3a","q3b","q3c","q3d","q3e","q3f","q3g","q3h","q3i","q3j","q3k","q3l","q_6","q_8")

    # Make sure question columns are numeric
    df[qs] <- lapply(df[qs], function(x) suppressWarnings(as.numeric(x)))

    # Try to find a subject identifier; if none, create one
    df$.subj <- seq_len(nrow(df))

    # Reshape to long: one row per (subject, question)
    long <- df %>%
      pivot_longer(all_of(qs), names_to = "question", values_to = "score") %>%
      mutate(question = factor(question))

    # Fit a mixed model: fixed effect of condition, random intercepts for subject and question
    # You can extend with random slopes if justified, e.g. (1 + conditions | .subj) or (1 + conditions | question)
    m <- lmer(score ~ conditions + (1 | .subj) + (1 | question), data = long, REML = TRUE)

    # Print a compact summary
    cat("=== Model summary ===\n")
    print(summary(m))

    ## # Tidy fixed effects for a quick table
    ## cat("\n=== Fixed effects (tidy) ===\n")
    ## fixef_tidy <- broom.mixed::tidy(m, effects = "fixed", conf.int = TRUE, conf.method = "Wald")
    ## print(fixef_tidy, row.names = FALSE)

  ## Optional: per-question models (still no broom.mixed)
  cat("\n=== Optional: per-question fixed effects (random intercept for subject) ===\n")
  per_q <- lapply(levels(long$question), function(qn){
    fm <- lmer(score ~ conditions + (1 | .subj), data = subset(long, question == qn), REML = TRUE)
    feq <- as.data.frame(coef(summary(fm)))
    feq$term <- rownames(feq)
    ciq <- suppressMessages(confint(fm, method = "Wald", parm = "beta_"))
    ciq_df <- data.frame(term = rownames(ciq), conf.low = ciq[,1], conf.high = ciq[,2])
    out <- feq %>%
      select(term, Estimate, `Std. Error`, `t value`) %>%
      left_join(ciq_df, by = "term") %>%
      mutate(question = qn) %>%
      select(question, everything())
    out
  })
  per_q <- do.call(rbind, per_q)
  print(per_q, row.names = FALSE)
#+END_SRC

#+RESULTS:
#+begin_example
=== Model summary ===
Linear mixed model fit by REML ['lmerMod']
Formula: score ~ conditions + (1 | .subj) + (1 | question)
   Data: long

REML criterion at convergence: 1887.6

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-2.26270 -0.74947 -0.00828  0.76180  2.61338 

Random effects:
 Groups   Name        Variance Std.Dev.
 .subj    (Intercept) 0.3633   0.6028  
 question (Intercept) 2.6393   1.6246  
 Residual             3.3636   1.8340  
Number of obs: 448, groups:  .subj, 32; question, 14

Fixed effects:
            Estimate Std. Error t value
(Intercept)   0.4454     0.4733   0.941
conditions2  -0.5168     0.2752  -1.878

Correlation of Fixed Effects:
            (Intr)
conditions2 -0.273

=== Optional: per-question fixed effects (random intercept for subject) ===
#+end_example





** COMMENT TMP


#+BEGIN_SRC gnuplot :file test.eps  :results file graphics
  reset
  set terminal cairolatex
  test
#+END_SRC

#+RESULTS:
[[file:test.eps]]


* COMMENT
- [X] KS test
- [ ] positive apriori -> other results  (odd ratio? correlation?)  (categorise into some groups)
- [ ] prolific perception test
  - choose 1 (laughter, sigh, hesitation, chuckle ) + confidence
  - with "Sorry" context and no context
  - function ?
  - valence ?
  - genuine / fake ? probably not
  - another stimulus (Apology vs Apology + L) 
    - Apology + sound 
  - context free -> with context -> (Apology vs Apology + L) (sincere? apologetic?)

| group | a1               | a2                          |
|-------+------------------+-----------------------------|
|     1 | L                | Apology+Laughter vs Apology |
|     2 | Apology+Laughter | Apology+Laughter vs Apology |

ACII + IVA (Mexico) / ICMI (Naples)

ISRE (Australia)

* Observations:
reciprocation:
- initial:
  - 5d403b7d4e509a0019f664f0_1 :: "no"
  - f5f39a2fd2d394917284dd66f_2 :: "hmhm" (laughter?) 
  - 675b5e7290000cc3ac23d411_1 :: ???
  - 6759fa50a9bb240e423de357_2 :: yah
- final:     
  - 5ee5defbfe74a3000d106f51_1 :: in-breath...
  - 5f98099d48060d0450394002_1  :: hmm (oh that was... (it?) ) <cut>q
  - 67803b5508f3d995ef13696b_2  :: oh
  - 6023f94d1951e70ae21770ec_1 :: applause


* References
#+print_bibliography:
